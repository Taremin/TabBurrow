# UIコンポーネントと実装 (`src/tabs/`)

## 技術スタック
*   **React**: UIフレームワーク
*   **react-virtuoso**: 大量データの描画パフォーマンス最適化（仮想スクロール）
*   **Lucide React**: アイコン
*   **CSS**: 通常のCSSファイル `tabs.css` を使用

## コンポーネント構成

### `App.tsx` (Root)
アプリケーション全体の状態管理を担当。
*   **State**: `allTabs` (全データ), `filteredTabs` (表示データ), `customGroups`, `searchQuery`, `viewMode`, `displayDensity` など。
*   **Effects**:
    *   起動時に `getAllTabs()` でIndexedDBからデータ読み込み。
    *   `browser.runtime.onMessage` でバックグラウンドからの更新通知（`tabs-changed`）を監視し、データをリロード。
    *   検索ワード、日付フィルタ、検索オプションの変更に応じて `filteredTabs` を更新。

### `TabList.tsx`
タブ一覧を表示する主要コンポーネント。
*   **GroupedVirtuoso**: データを「カスタムグループ」と「ドメイングループ」に分類して表示。
*   **グループ化ロジック**:
    1.  `tabs` 配列を走査し、Mapに分類。
    2.  設定 (`groupSort`) に基づいてグループ順序をソート。
    3.  各グループ内のタブを設定 (`itemSort`) に基づいてソート。
    4.  フラットな配列とグループカウントを生成してVirtuosoに渡す。

### `TabCard.tsx`
個々のタブを表示するカードコンポーネント。
*   **機能**:
    *   クリックでタブを開く（復元）。
    *   削除ボタンで個別削除。
    *   グループ移動メニュー。
*   **UI**: スクリーンショット、ファビコン、タイトル、ドメイン、保存からの経過時間を表示。

### `GroupHeader.tsx`
グループヘッダーコンポーネント。
*   **機能**:
    *   グループの折りたたみ/展開。
    *   「すべて開く」ボタン（タブグループとして開くオプション含む）。
    *   グループ削除ボタン。

### `Header.tsx`
検索バー、統計情報、操作ボタンを含むヘッダー。
*   **検索オプション**: 大文字小文字区別、単語単位検索、正規表現モードのトグル。
*   **日付フィルタ**: `DateRangeFilter` コンポーネントによる期間指定。
*   **表示切替**: グループ表示/フラット表示、通常/コンパクト表示の切替。
*   **リンクチェック**: リンクチェックダイアログの呼び出し。

### `ConfirmDialog.tsx`
汎用確認ダイアログ。
*   **機能**: タイトル、メッセージ、確認/キャンセルボタンをカスタマイズ可能。
*   **用途**: タブ一括削除、全タブ開く時の確認など。

### `LinkCheckDialog.tsx`
リンクチェック機能のダイアログ。
*   **機能**:
    *   リンク切れチェックの開始/一時停止/再開。
    *   進捗表示（プログレスバー、チェック済み件数）。
    *   結果表示（正常/警告/リンク切れの分類）。
    *   リンク切れタブの一括削除。

### `DateRangeFilter.tsx`
日付範囲フィルタコンポーネント。
*   **機能**: カレンダーUIで開始日・終了日を指定してフィルタリング。

## パフォーマンス考慮事項
*   **仮想スクロール**: 数千件のタブがあってもDOM要素数は一定に保たれ、メモリ消費と描画負荷を低減。
*   **画像遅延読み込み**: TabCardが表示されるまで画像の描画負荷を分散（Virtuosoにより画面外はレンダリングされない）。
